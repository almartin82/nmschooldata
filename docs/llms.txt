# nmschooldata

[![R-CMD-check](https://github.com/almartin82/nmschooldata/actions/workflows/R-CMD-check.yaml/badge.svg)](https://github.com/almartin82/nmschooldata/actions/workflows/R-CMD-check.yaml)
[![Python
Tests](https://github.com/almartin82/nmschooldata/actions/workflows/python-test.yaml/badge.svg)](https://github.com/almartin82/nmschooldata/actions/workflows/python-test.yaml)
[![Lifecycle:
experimental](https://img.shields.io/badge/lifecycle-experimental-orange.svg)](https://lifecycle.r-lib.org/articles/stages.html#experimental)

Fetch and analyze New Mexico school enrollment data from the New Mexico
Public Education Department (PED) in R or Python.

## What can you find with nmschooldata?

**10 years of enrollment data (2016-2025).** Around 330,000 students. 89
school districts. Here are ten stories hiding in the numbers:

------------------------------------------------------------------------

### 1. A majority-minority state

New Mexico is one of the most diverse states in the nation. Hispanic
students make up over 60% of enrollment, with significant Native
American representation.

``` r
library(nmschooldata)
library(dplyr)

enr <- fetch_enr(2023)

enr %>%
  filter(is_state, grade_level == "TOTAL", subgroup != "total") %>%
  filter(subgroup %in% c("hispanic", "white", "native_american", "black", "asian")) %>%
  mutate(pct = pct * 100) %>%
  select(subgroup, n_students, pct) %>%
  arrange(desc(n_students))
```

------------------------------------------------------------------------

### 2. The Native American education landscape

New Mexico has the third-highest Native American student population in
the country, concentrated in districts near the Navajo Nation, Zuni, and
numerous Pueblos.

``` r
enr <- fetch_enr(2023)

enr %>%
  filter(is_district, grade_level == "TOTAL", subgroup == "native_american") %>%
  arrange(desc(n_students)) %>%
  head(10) %>%
  select(district_name, n_students, pct)
```

------------------------------------------------------------------------

### 3. Enrollment has been declining

Like many western states, New Mexico’s K-12 enrollment peaked and has
been slowly declining.

``` r
enr <- fetch_enr_multi(2019:2023)

enr %>%
  filter(is_state, grade_level == "TOTAL", subgroup == "total") %>%
  select(end_year, n_students) %>%
  mutate(change = n_students - lag(n_students))
```

------------------------------------------------------------------------

### 4. COVID hit New Mexico schools hard

The pandemic caused notable enrollment drops, especially in early
elementary grades where families delayed kindergarten entry.

``` r
enr <- fetch_enr_multi(2019:2023)

enr %>%
  filter(is_state, subgroup == "total",
         grade_level %in% c("K", "01", "06", "09")) %>%
  select(end_year, grade_level, n_students) %>%
  tidyr::pivot_wider(names_from = grade_level, values_from = n_students)
```

------------------------------------------------------------------------

### 5. Albuquerque dominates, but is shrinking

Albuquerque Public Schools serves roughly one-quarter of all New Mexico
students, but the district has been losing enrollment faster than the
state average.

``` r
enr <- fetch_enr_multi(2019:2023)

enr %>%
  filter(is_district, grade_level == "TOTAL", subgroup == "total",
         grepl("Albuquerque", district_name)) %>%
  select(end_year, district_name, n_students) %>%
  mutate(
    change_pct = (n_students / first(n_students) - 1) * 100
  )
```

------------------------------------------------------------------------

### 6. Rural and urban divide

New Mexico’s schools range from large urban districts like Albuquerque
and Las Cruces to tiny rural districts serving fewer than 100 students.

``` r
enr <- fetch_enr(2023)

# District size distribution
enr %>%
  filter(is_district, grade_level == "TOTAL", subgroup == "total") %>%
  mutate(size_category = case_when(
    n_students >= 10000 ~ "Large (10k+)",
    n_students >= 1000 ~ "Medium (1k-10k)",
    n_students >= 100 ~ "Small (100-1k)",
    TRUE ~ "Tiny (<100)"
  )) %>%
  group_by(size_category) %>%
  summarize(
    n_districts = n(),
    total_students = sum(n_students)
  )
```

------------------------------------------------------------------------

### 7. High economic disadvantage rates

New Mexico has one of the highest child poverty rates in the country.
The economically disadvantaged student data tells this story.

``` r
enr <- fetch_enr(2023)

enr %>%
  filter(is_state, grade_level == "TOTAL", subgroup == "econ_disadv") %>%
  select(n_students, pct)
```

------------------------------------------------------------------------

### 8. English Learners in a bilingual state

New Mexico’s border location and cultural heritage means a significant
English Learner population.

``` r
enr <- fetch_enr(2023)

# State-level EL enrollment
enr %>%
  filter(is_state, grade_level == "TOTAL", subgroup == "ell") %>%
  select(n_students, pct)

# Districts with highest EL populations
enr %>%
  filter(is_district, grade_level == "TOTAL", subgroup == "ell") %>%
  arrange(desc(n_students)) %>%
  head(10) %>%
  select(district_name, n_students, pct)
```

------------------------------------------------------------------------

### 9. Grade-level patterns

New Mexico follows national patterns with smaller kindergarten cohorts
than upper grades, a demographic shift that will work its way through
the system.

``` r
enr <- fetch_enr(2023)

enr %>%
  filter(is_state, subgroup == "total",
         grade_level %in% c("PK", "K", "01", "05", "08", "12")) %>%
  select(grade_level, n_students) %>%
  arrange(match(grade_level, c("PK", "K", "01", "05", "08", "12")))
```

------------------------------------------------------------------------

### 10. The charter school landscape

New Mexico has a significant charter school sector. Compare district-run
schools versus charter schools across the state.

``` r
enr <- fetch_enr(2023)

# Schools by type
enr %>%
  filter(is_school, grade_level == "TOTAL", subgroup == "total") %>%
  mutate(is_charter = grepl("Charter|Academy", school_name, ignore.case = TRUE)) %>%
  group_by(is_charter) %>%
  summarize(
    n_schools = n(),
    total_enrollment = sum(n_students)
  )
```

------------------------------------------------------------------------

## Enrollment Visualizations

![New Mexico statewide enrollment
trends](https://almartin82.github.io/nmschooldata/articles/enrollment_hooks_files/figure-html/statewide-chart-1.png)

![Top New Mexico
districts](https://almartin82.github.io/nmschooldata/articles/enrollment_hooks_files/figure-html/top-districts-chart-1.png)

See the [full
vignette](https://almartin82.github.io/nmschooldata/articles/enrollment_hooks.html)
for more insights.

## Installation

``` r
# install.packages("remotes")
remotes::install_github("almartin82/state-schooldata", subdir = "nmschooldata")
```

## Quick start

### R

``` r
library(nmschooldata)
library(dplyr)

# Fetch one year
enr_2023 <- fetch_enr(2023)

# Fetch multiple years
enr_multi <- fetch_enr_multi(2019:2023)

# State totals
enr_2023 %>%
  filter(is_state, subgroup == "total", grade_level == "TOTAL")

# District breakdown
enr_2023 %>%
  filter(is_district, subgroup == "total", grade_level == "TOTAL") %>%
  arrange(desc(n_students))

# Demographics statewide
enr_2023 %>%
  filter(is_state, grade_level == "TOTAL",
         subgroup %in% c("hispanic", "white", "native_american", "black", "asian")) %>%
  select(subgroup, n_students, pct)
```

### Python

``` python
import pynmschooldata as nm

# Check available years
years = nm.get_available_years()
print(f"Data available: {years['min_year']}-{years['max_year']}")

# Fetch one year
enr_2023 = nm.fetch_enr(2023)

# Fetch multiple years
enr_multi = nm.fetch_enr_multi([2019, 2020, 2021, 2022, 2023])

# State totals
state_total = enr_2023[
    (enr_2023['is_state'] == True) &
    (enr_2023['subgroup'] == 'total') &
    (enr_2023['grade_level'] == 'TOTAL')
]

# District breakdown
districts = enr_2023[
    (enr_2023['is_district'] == True) &
    (enr_2023['subgroup'] == 'total') &
    (enr_2023['grade_level'] == 'TOTAL')
].sort_values('n_students', ascending=False)
```

## Data availability

| Years         | Source            | Aggregation Levels      | Demographics | Grade Breakdown |
|---------------|-------------------|-------------------------|--------------|-----------------|
| **2025**      | 40-Day subgroup   | State, District, School | 13 subgroups | TOTAL only      |
| **2024**      | 80-Day only       | State, District         | None         | PK through 12   |
| **2019-2023** | 40-Day subgroup   | State, School           | 13 subgroups | TOTAL only      |
| **2016-2018** | 40-Day enrollment | State, District, School | None         | PK through 12   |

### What’s available by year range

- **Demographics**: 13 subgroups (race/ethnicity, gender, special
  populations) available for 2019-2023 and 2025. No demographics for
  2016-2018 or 2024.
- **Grade Breakdown**: Individual grade counts (PK-12) available for
  2016-2018 and 2024. Only TOTAL for 2019-2023 and 2025.
- **40-Day vs 80-Day**: New Mexico reports enrollment at 40-day and
  80-day counts. This package uses 40-day data when available (the
  standard snapshot used for funding). **Note: 2024 only has 80-Day
  data** - the 40-Day subgroup file was never published by NM PED.

## Data source

New Mexico Public Education Department: - [PED
Main](https://webnew.ped.state.nm.us/) - [STARS
System](https://web.ped.nm.gov/bureaus/information-technology/stars/) -
[NM Vistas](https://nmvistas.org/)

## Part of the State Schooldata Project

A simple, consistent interface for accessing state-published school data
in Python and R.

**All 50 state packages:**
[github.com/almartin82](https://github.com/almartin82?tab=repositories&q=schooldata)

## Author

[Andy Martin](https://github.com/almartin82) (<almartin@gmail.com>)

## License

MIT

# Package index

## Fetch Data

- [`fetch_enr()`](https://almartin82.github.io/nmschooldata/reference/fetch_enr.md)
  : Fetch New Mexico enrollment data
- [`fetch_enr_multi()`](https://almartin82.github.io/nmschooldata/reference/fetch_enr_multi.md)
  : Fetch enrollment data for multiple years
- [`get_available_years()`](https://almartin82.github.io/nmschooldata/reference/get_available_years.md)
  : Get available years for enrollment data
- [`get_valid_years()`](https://almartin82.github.io/nmschooldata/reference/get_valid_years.md)
  : Get valid enrollment years

## Process & Tidy

- [`tidy_enr()`](https://almartin82.github.io/nmschooldata/reference/tidy_enr.md)
  : Tidy enrollment data
- [`id_enr_aggs()`](https://almartin82.github.io/nmschooldata/reference/id_enr_aggs.md)
  : Identify enrollment aggregation levels
- [`enr_grade_aggs()`](https://almartin82.github.io/nmschooldata/reference/enr_grade_aggs.md)
  : Custom Enrollment Grade Level Aggregates

## Cache Management

- [`cache_status()`](https://almartin82.github.io/nmschooldata/reference/cache_status.md)
  : Show cache status
- [`clear_cache()`](https://almartin82.github.io/nmschooldata/reference/clear_cache.md)
  : Clear the nmschooldata cache

# Articles

### All vignettes

- [Understanding NM PED Data
  Availability](https://almartin82.github.io/nmschooldata/articles/data_availability.md):
- [10 Insights from New Mexico School Enrollment
  Data](https://almartin82.github.io/nmschooldata/articles/enrollment_hooks.md):
